!function(){"use strict";const e=(l,e)=>{let c=1;var o=document.createElement("style");function i(){l.dom.select('a[role="doc-noteref"]').forEach((e,o)=>{var t=e,e=e.querySelector("sup");e&&(e.textContent=`[${o+1}]`),t.href="#footnote-entry-"+(o+1),t.id=`footnote-entry-${o+1}-ref`}),l.dom.select('li[id^="footnote-"]').forEach((e,o)=>{e.id="footnote-entry-"+(o+1);e=e.querySelector('a[role="doc-backlink"]');e&&(e.href=`#footnote-entry-${o+1}-ref`)})}o.type="text/css",o.appendChild(document.createTextNode(`
        .footnote-highlight {
            background-color: yellow !important;
        }
    `)),document.head.appendChild(o),l.ui.registry.addButton("a11y-footnotes",{icon:"custom-footnote-icon",tooltip:"Insert Footnote",onAction:()=>{const a=l.selection.getContent({format:"text"});a?l.windowManager.open({title:"Insert Footnote",body:{type:"panel",items:[{type:"input",name:"footnoteText",label:"Footnote Text"}]},buttons:[{type:"cancel",text:"Cancel"},{type:"submit",text:"Save",primary:!0}],onSubmit:function(e){var o=e.getData(),t=a,o=o.footnoteText,n="footnote-"+(new Date).getTime(),r=c++,t=`<span>${t}<a id="footnote-entry-${n}-ref" role="doc-noteref" aria-labelledby="footnote-entry-${n}" href="#footnote-entry-${n}"><sup>[${r}]</sup></a></span>`,r=`
            <li id="footnote-entry-${n}">
                <span contenteditable="true">${o}</span>
                <a role="doc-backlink" href="#footnote-entry-${n}-ref" aria-label="Back to content">â†µ</a>
            </li>`;l.insertContent(t),(o=l.dom.select('section[role="doc-footnotes"] ol')[0])?o.innerHTML+=r:l.setContent(l.getContent()+`<hr /><section role="doc-footnotes" aria-label="footnotes" contenteditable="false">
                <h3 class="sr-only" id="footnotes-block-${n}">Footnotes</h3>
                <ol>${r.trim()}</ol>
            </section>`),i(),e.close()}}):l.windowManager.alert("Please select a word or text to add a footnote.")}}),l.ui.registry.addIcon("custom-footnote-icon",'<img src="/a11y-footnotes/icons/footnote.svg" style="height: 28px; width: 28px;"/>'),l.on("input",function(){const t=l.dom.select('a[role="doc-noteref"]').map(e=>e.id.replace("-ref",""));l.dom.select('li[id^="footnote-"]').forEach(o=>{var e=o.id;t.includes(e)||l.windowManager.confirm("The reference number for this footnote has been deleted. Do you want to delete the footnote as well?",function(e){e&&l.dom.remove(o)})});var e=l.dom.select('section[role="doc-footnotes"]')[0];e&&0===e.querySelectorAll("li").length&&l.dom.remove(e),i()})};tinymce.PluginManager.add("a11y-footnotes",e)}();